<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>AffineConstructive.tactics.quote.rewrite_preserves</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library AffineConstructive.tactics.quote.rewrite_preserves</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="AffineConstructive.interfaces.abstract_algebra.html#"><span class="id" title="library">abstract_algebra</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="AffineConstructive.interfaces.prop_eq.html#"><span class="id" title="library">prop_eq</span></a> <a class="idref" href="AffineConstructive.tactics.misc.html#"><span class="id" title="library">tactics.misc</span></a> <a class="idref" href="AffineConstructive.tactics.rewrite.rewrite.html#"><span class="id" title="library">rewrite</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="AffineConstructive.tactics.quote.base.html#"><span class="id" title="library">quote.base</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="quote_tag" class="idref" href="#quote_tag"><span class="id" title="definition">quote_tag</span></a> `(<a id="f:3" class="idref" href="#f:3"><span class="id" title="binder">f</span></a>:<a id="X:1" class="idref" href="#X:1"><span class="id" title="binder">X</span></a> <a class="idref" href="AffineConstructive.interfaces.set.html#b0e233f2f2b3c047123c6b17789ec7e0"><span class="id" title="notation">⇾</span></a> <a id="Y:2" class="idref" href="#Y:2"><span class="id" title="binder">Y</span></a>) <a id="x:4" class="idref" href="#x:4"><span class="id" title="binder">x</span></a> := <a class="idref" href="AffineConstructive.tactics.quote.rewrite_preserves.html#f:3"><span class="id" title="variable">f</span></a> <a class="idref" href="AffineConstructive.tactics.quote.rewrite_preserves.html#x:4"><span class="id" title="variable">x</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a id="quote_tag_eq" class="idref" href="#quote_tag_eq"><span class="id" title="definition">quote_tag_eq</span></a> `(<a id="f:7" class="idref" href="#f:7"><span class="id" title="binder">f</span></a>:<a id="X:5" class="idref" href="#X:5"><span class="id" title="binder">X</span></a> <a class="idref" href="AffineConstructive.interfaces.set.html#b0e233f2f2b3c047123c6b17789ec7e0"><span class="id" title="notation">⇾</span></a> <a id="Y:6" class="idref" href="#Y:6"><span class="id" title="binder">Y</span></a>) <a id="x:8" class="idref" href="#x:8"><span class="id" title="binder">x</span></a> : <a class="idref" href="AffineConstructive.tactics.quote.rewrite_preserves.html#quote_tag"><span class="id" title="definition">quote_tag</span></a> <a class="idref" href="AffineConstructive.tactics.quote.rewrite_preserves.html#f:7"><span class="id" title="variable">f</span></a> <a class="idref" href="AffineConstructive.tactics.quote.rewrite_preserves.html#x:8"><span class="id" title="variable">x</span></a> <a class="idref" href="AffineConstructive.interfaces.prop_eq.html#dc8d630d628b8527318d6b8ab8ce8456"><span class="id" title="notation">≡</span></a> <a class="idref" href="AffineConstructive.tactics.quote.rewrite_preserves.html#f:7"><span class="id" title="variable">f</span></a> <a class="idref" href="AffineConstructive.tactics.quote.rewrite_preserves.html#x:8"><span class="id" title="variable">x</span></a> := <a class="idref" href="AffineConstructive.interfaces.prop_eq.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a>.<br/>

<br/>
</div>

<div class="doc">
Returns the constr <span class="inlinecode"><a class="idref" href="AffineConstructive.implementations.signed_naturals_integers.html#signed_naturals.t"><span class="id" title="inductive">t</span></a></span> with <span class="inlinecode"><span class="id" title="var">lrewrite_tag_l</span></span> replaced by <span class="inlinecode"><span class="id" title="var">lewrite_tag_r</span></span> 
</div>
<div class="code">
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">quote_swap_tags</span> <span class="id" title="var">t</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">context</span> <span class="id" title="var">C</span> [ <a class="idref" href="AffineConstructive.tactics.rewrite.arewrite.html#arewrite_tag_l"><span class="id" title="definition">arewrite_tag_l</span></a> ?<span class="id" title="var">E</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">t'</span> := <span class="id" title="keyword">context</span> <span class="id" title="var">C</span> [ <a class="idref" href="AffineConstructive.tactics.rewrite.arewrite.html#arewrite_tag_r"><span class="id" title="definition">arewrite_tag_r</span></a> <span class="id" title="var">E</span> ] <span class="id" title="tactic">in</span> <span class="id" title="var">quote_swap_tags</span> <span class="id" title="var">t'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Finds all "tagged" occurences in <span class="inlinecode"><span class="id" title="var">tagged_tm</span></span> of <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode">?<span class="id" title="var">x</span></span> ---
   that is, subterms <span class="inlinecode"><a class="idref" href="AffineConstructive.tactics.quote.rewrite_preserves.html#quote_tag"><span class="id" title="definition">quote_tag</span></a></span> <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> --- quotes them with
   quote_source, introducing equations <span class="inlinecode"><span class="id" title="var">E</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">_</span></span> into the context,
   finally running the continuation <span class="inlinecode"><span class="id" title="var">k</span></span>, passing <span class="inlinecode"><span class="id" title="var">tagged_tm</span></span> with
   each subterm <span class="inlinecode"><a class="idref" href="AffineConstructive.tactics.quote.rewrite_preserves.html#quote_tag"><span class="id" title="definition">quote_tag</span></a></span> <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> replaced by <span class="inlinecode"><span class="id" title="var">lrewrite_tag_l</span></span> <span class="inlinecode">?<span class="id" title="var">E</span></span> 
</div>
<div class="code">
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">quote_tagged_subterms_then</span> <span class="id" title="var">f</span> <span class="id" title="var">tagged_tm</span> <span class="id" title="var">k</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">tagged_tm</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="keyword">context</span> <span class="id" title="var">C</span> [ @<a class="idref" href="AffineConstructive.tactics.quote.rewrite_preserves.html#quote_tag"><span class="id" title="definition">quote_tag</span></a> ?<span class="id" title="var">X</span> ?<span class="id" title="var">Y</span> ?<span class="id" title="var">f</span> ?<span class="id" title="var">x</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">q</span> := <span class="id" title="var">quote_source</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">q</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="AffineConstructive.tactics.quote.base.html#quote_refl"><span class="id" title="definition">quote_refl</span></a> <span class="id" title="var">f</span> <span class="id" title="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">t'</span> := <span class="id" title="keyword">context</span> <span class="id" title="var">C</span> [ <a class="idref" href="AffineConstructive.interfaces.set.html#func_op"><span class="id" title="projection">func_op</span></a> <span class="id" title="var">f</span> <span class="id" title="var">x</span> ] <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">quote_tagged_subterms_then</span> <span class="id" title="var">f</span> <span class="id" title="var">t'</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">E</span> := <span class="id" title="tactic">fresh</span> "E" <span class="id" title="tactic">in</span> <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <span class="id" title="var">q</span> <span class="id" title="keyword">as</span> <span class="id" title="var">E</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="AffineConstructive.tactics.quote.base.html#quote"><span class="id" title="definition">quote</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">t'</span> := <span class="id" title="keyword">context</span> <span class="id" title="var">C</span> [ <a class="idref" href="AffineConstructive.tactics.rewrite.arewrite.html#arewrite_tag_l"><span class="id" title="definition">arewrite_tag_l</span></a> <span class="id" title="var">E</span> ] <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">quote_tagged_subterms_then</span> <span class="id" title="var">f</span> <span class="id" title="var">t'</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">k</span> <span class="id" title="var">tagged_tm</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Tags occurences of <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode">?<span class="id" title="var">x</span></span> in <span class="inlinecode"><span class="id" title="var">tm</span></span> and invokes <span class="inlinecode"><span class="id" title="var">quote_tagged_subterms</span></span> 
</div>
<div class="code">
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">tag_and_quote_then</span> <span class="id" title="var">f</span> <span class="id" title="var">tm</span> <span class="id" title="var">k</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">tagged_tm</span> := <span class="id" title="var">run_tactic_on_term</span> <span class="id" title="var">tm</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">rewrite</span> &lt;-?(<a class="idref" href="AffineConstructive.tactics.quote.rewrite_preserves.html#quote_tag_eq"><span class="id" title="definition">quote_tag_eq</span></a> <span class="id" title="var">f</span> <span class="id" title="var">_</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">quote_tagged_subterms_then</span> <span class="id" title="var">f</span> <span class="id" title="var">tagged_tm</span> <span class="id" title="var">k</span>.<br/>

<br/>
</div>

<div class="doc">
Rewrite occurences of <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode">?<span class="id" title="var">x</span></span> in the goal, expanding any structure
   preserving properties 
</div>
<div class="code">
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">rewrite_preserves</span> <span class="id" title="var">f</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">g</span> := <span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- ?<span class="id" title="var">G</span> ⇒ <span class="id" title="var">G</span> <span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">notypeclasses</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">_</span>); [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">clear_tags</span> <span class="id" title="var">t</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">unfold</span> <span class="id" title="var">arewrite_tag_l</span>, <span class="id" title="var">arewrite_tag_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">with_tagged_term</span> <span class="id" title="var">tagged_Q</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">tagged_P</span> := <span class="id" title="var">quote_swap_tags</span> <span class="id" title="var">tagged_Q</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">pf</span> := <span class="id" title="var">proper_solution</span> (<a class="idref" href="AffineConstructive.interfaces.sprop.html#impl"><span class="id" title="definition">sprop.impl</span></a> <span class="id" title="var">tagged_P</span> <span class="id" title="var">tagged_Q</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">P</span> := <span class="id" title="var">clear_tags</span> <span class="id" title="var">tagged_P</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Q</span> := <span class="id" title="var">clear_tags</span> <span class="id" title="var">tagged_Q</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">echange</span> (<a class="idref" href="AffineConstructive.interfaces.sprop.html#impl"><span class="id" title="definition">sprop.impl</span></a> <span class="id" title="var">P</span> <span class="id" title="var">Q</span>)); <span class="id" title="tactic">refine</span> <span class="id" title="var">pf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tag_and_quote_then</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">with_tagged_term</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ].<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>